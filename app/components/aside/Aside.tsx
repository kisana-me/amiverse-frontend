"use client";

import "./style.css"
import Link from "next/link";
import { useOverlay } from "@/app/providers/OverlayProvider";
import { useTrends } from "@/app/providers/TrendsProvider";
import SkeletonBox from "../skeletons/skeleton_box";
import Footer from "../footer/Footer";

export default function Aside() {
  const { isAsideMenuOpen } = useOverlay();
  const { trends, trendsLoading } = useTrends();

  // Get the first trend category and display its top 5 items
  const trendData = trends.length > 0 ? trends[0] : null;
  const topTrends = trendData?.ranking.slice(0, 5) || [];

  return (
    <aside className={isAsideMenuOpen ? 'show-aside' : ''}>
      <div className="aside-content">
        {/* Trends Section */}
        <div className="aside-section">
          <h2 className="aside-section-title">トレンド</h2>
          {trendsLoading ? (
            <div className="aside-trend-list">
              {[...Array(5)].map((_, index) => (
                <div className="aside-trend-item" key={index}>
                  <div className="aside-trend-rank">
                    <SkeletonBox width="30px" height="14px" />
                  </div>
                  <div className="aside-trend-word">
                    <SkeletonBox width="100px" height="16px" />
                  </div>
                  <div className="aside-trend-count">
                    <SkeletonBox width="40px" height="14px" />
                  </div>
                </div>
              ))}
            </div>
          ) : (
            <>
              <div className="aside-trend-list">
                {topTrends.map((trend, index) => (
                  <Link 
                    href={`/search?query=${encodeURIComponent(trend.word)}`} 
                    className="aside-trend-item" 
                    key={index}
                  >
                    <div className="aside-trend-rank">{index + 1}位</div>
                    <div className="aside-trend-word">{trend.word}</div>
                    <div className="aside-trend-count">{trend.count}件</div>
                  </Link>
                ))}
              </div>
              <Link href="/discovery" className="aside-more-link">
                もっと見る
              </Link>
            </>
          )}
        </div>

        {/* Links Section */}
        <div className="aside-section">
          <h2 className="aside-section-title">リンク</h2>
          <div className="aside-links">
            <Link href="/discovery" className="aside-link-item">
              <div className="aside-link-icon">
                <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path fillRule="evenodd" clipRule="evenodd" d="M45 75C28.4315 75 15 61.5685 15 45C15 28.4315 28.4315 15 45 15C61.5685 15 75 28.4315 75 45C75 61.5685 61.5685 75 45 75ZM10 45C10 25.67 25.67 10 45 10C64.33 10 80 25.67 80 45C80 53.7652 76.778 61.7778 71.4537 67.9181L89.7405 86.2049C90.7168 87.1812 90.7168 88.7642 89.7405 89.7405C88.7642 90.7168 87.1812 90.7168 86.2049 89.7405L67.9181 71.4537C61.7778 76.778 53.7652 80 45 80C25.67 80 10 64.33 10 45Z" fill="currentColor"/>
                </svg>
              </div>
              <div className="aside-link-text">検索・発見</div>
            </Link>
            <Link href="/communities" className="aside-link-item">
              <div className="aside-link-icon">
                <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path fillRule="evenodd" clipRule="evenodd" d="M40 26C40 31.5228 44.4772 36 50 36C55.5229 36 60 31.5228 60 26C60 20.4772 55.5229 16 50 16C44.4772 16 40 20.4772 40 26ZM50 11C41.7157 11 35 17.7157 35 26C35 34.2843 41.7157 41 50 41C58.2843 41 65 34.2843 65 26C65 17.7157 58.2843 11 50 11ZM74 38C74 41.3137 76.6863 44 80 44C83.3137 44 86 41.3137 86 38C86 34.6863 83.3137 32 80 32C76.6863 32 74 34.6863 74 38ZM80 27C73.9249 27 69 31.9249 69 38C69 44.0751 73.9249 49 80 49C86.0751 49 91 44.0751 91 38C91 31.9249 86.0751 27 80 27ZM20 44C16.6863 44 14 41.3137 14 38C14 34.6863 16.6863 32 20 32C23.3137 32 26 34.6863 26 38C26 41.3137 23.3137 44 20 44ZM9 38C9 31.9249 13.9249 27 20 27C26.0751 27 31 31.9249 31 38C31 44.0751 26.0751 49 20 49C13.9249 49 9 44.0751 9 38ZM67.3996 84L65.0643 63.4494C64.1937 55.7878 57.711 50 50 50C42.289 50 35.8063 55.7878 34.9357 63.4494L32.6004 84H67.3996ZM68.8759 58.0685C71.5906 54.9493 75.5865 53 80 53C87.5579 53 93.8912 58.7164 94.663 66.2348L96.4867 84L97 89H91.9737H73H67.9678H32.0322H27H8.02628H3L3.51329 84L5.33701 66.2348C6.10882 58.7164 12.4421 53 20 53C24.4135 53 28.4094 54.9493 31.1241 58.0685C34.0147 50.3662 41.4379 45 50 45C58.5621 45 65.9853 50.3662 68.8759 58.0685ZM27.5682 84L29.6019 66.1036C28.8132 61.4556 24.7768 58 20 58C15.0058 58 10.8209 61.7773 10.3109 66.7454L8.53956 84H27.5682ZM72.4318 84L70.3981 66.1036C71.1868 61.4556 75.2232 58 80 58C84.9942 58 89.1791 61.7773 89.6891 66.7454L91.4604 84H72.4318Z" fill="currentColor"/>
                </svg>
              </div>
              <div className="aside-link-text">コミュニティ</div>
            </Link>
            <Link href="/dashboard" className="aside-link-item">
              <div className="aside-link-icon">
                <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <mask id="path-1-inside-1_43_10" fill="white">
                    <path fillRule="evenodd" clipRule="evenodd" d="M19 15C16.7909 15 15 16.7909 15 19V41C15 43.2091 16.7909 45 19 45H41C43.2091 45 45 43.2091 45 41V19C45 16.7909 43.2091 15 41 15H19ZM66 15C59.9249 15 55 19.9249 55 26V45H74C80.0751 45 85 40.0751 85 34V15H66ZM15 66C15 59.9249 19.9249 55 26 55H45V74C45 80.0751 40.0751 85 34 85H15V66ZM59 55C56.7909 55 55 56.7909 55 59V81C55 83.2091 56.7909 85 59 85H81C83.2091 85 85 83.2091 85 81V59C85 56.7909 83.2091 55 81 55H59Z"/>
                  </mask>
                  <path d="M55 45H50V50H55V45ZM85 15H90V10H85V15ZM45 55H50V50H45V55ZM15 85H10V90H15V85ZM20 19C20 19.5523 19.5523 20 19 20V10C14.0294 10 10 14.0294 10 19H20ZM20 41V19H10V41H20ZM19 40C19.5523 40 20 40.4477 20 41H10C10 45.9706 14.0294 50 19 50V40ZM41 40H19V50H41V40ZM40 41C40 40.4477 40.4477 40 41 40V50C45.9706 50 50 45.9706 50 41H40ZM40 19V41H50V19H40ZM41 20C40.4477 20 40 19.5523 40 19H50C50 14.0294 45.9706 10 41 10V20ZM19 20H41V10H19V20ZM60 26C60 22.6863 62.6863 20 66 20V10C57.1634 10 50 17.1634 50 26H60ZM60 45V26H50V45H60ZM74 40H55V50H74V40ZM80 34C80 37.3137 77.3137 40 74 40V50C82.8366 50 90 42.8366 90 34H80ZM80 15V34H90V15H80ZM66 20H85V10H66V20ZM26 50C17.1634 50 10 57.1634 10 66H20C20 62.6863 22.6863 60 26 60V50ZM45 50H26V60H45V50ZM50 74V55H40V74H50ZM34 90C42.8366 90 50 82.8366 50 74H40C40 77.3137 37.3137 80 34 80V90ZM15 90H34V80H15V90ZM10 66V85H20V66H10ZM60 59C60 59.5523 59.5523 60 59 60V50C54.0294 50 50 54.0294 50 59H60ZM60 81V59H50V81H60ZM59 80C59.5523 80 60 80.4477 60 81H50C50 85.9706 54.0294 90 59 90V80ZM81 80H59V90H81V80ZM80 81C80 80.4477 80.4477 80 81 80V90C85.9706 90 90 85.9706 90 81H80ZM80 59V81H90V59H80ZM81 60C80.4477 60 80 59.5523 80 59H90C90 54.0294 85.9706 50 81 50V60ZM59 60H81V50H59V60Z" fill="currentColor" mask="url(#path-1-inside-1_43_10)"/>
                </svg>
              </div>
              <div className="aside-link-text">ダッシュボード</div>
            </Link>
            <Link href="/settings" className="aside-link-item">
              <div className="aside-link-icon">
                <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <mask id="path-1-inside-1_68_39" fill="white">
                    <path fillRule="evenodd" clipRule="evenodd" d="M40.1154 11.7859C40.2248 10.77 41.0822 10 42.1039 10H57.8961C58.9178 10 59.7752 10.77 59.8846 11.7859L60.825 20.5179C60.9066 21.2753 61.4137 21.9151 62.1172 22.2073C64.2648 23.0994 66.282 24.2422 68.1323 25.5992C68.7337 26.0402 69.5235 26.1479 70.2056 25.8463L78.1521 22.3326C79.0865 21.9194 80.1821 22.277 80.6929 23.1618L88.5891 36.8383C89.0999 37.7231 88.8617 38.8507 88.0367 39.4533L80.735 44.7869C80.1504 45.2139 79.8477 45.9231 79.9057 46.6448C79.9682 47.4216 80 48.2071 80 49V51C80 51.7929 79.9682 52.5784 79.9057 53.3552C79.8477 54.0769 80.1504 54.7861 80.735 55.2131L88.0367 60.5467C88.8618 61.1493 89.0999 62.2769 88.5891 63.1617L80.6929 76.8382C80.1821 77.723 79.0865 78.0806 78.1521 77.6674L70.2056 74.1537C69.5235 73.8521 68.7337 73.9598 68.1323 74.4008C66.282 75.7578 64.2648 76.9006 62.1172 77.7927C61.4137 78.0849 60.9066 78.7247 60.825 79.4821L59.8846 88.2141C59.7752 89.2299 58.9178 90 57.8961 90H42.1039C41.0822 90 40.2248 89.2299 40.1154 88.2141L39.175 79.4821C39.0934 78.7247 38.5863 78.0849 37.8828 77.7927C35.7352 76.9006 33.718 75.7578 31.8677 74.4008C31.2663 73.9598 30.4765 73.8521 29.7945 74.1537L21.8479 77.6674C20.9135 78.0806 19.8179 77.7231 19.307 76.8383L11.4109 63.1618C10.9001 62.277 11.1382 61.1494 11.9633 60.5468L19.265 55.2132C19.8496 54.7861 20.1523 54.0769 20.0943 53.3553C20.0318 52.5784 20 51.7929 20 51V49C20 48.2071 20.0318 47.4216 20.0943 46.6447C20.1523 45.9231 19.8496 45.2139 19.265 44.7868L11.9633 39.4532C11.1382 38.8506 10.9001 37.723 11.4109 36.8382L19.307 23.1617C19.8179 22.2769 20.9135 21.9194 21.8479 22.3326L29.7945 25.8463C30.4765 26.1479 31.2663 26.0402 31.8677 25.5992C33.718 24.2422 35.7352 23.0994 37.8828 22.2073C38.5863 21.9151 39.0934 21.2753 39.175 20.5179L40.1154 11.7859ZM50 42C45.5817 42 42 45.5817 42 50C42 54.4183 45.5817 58 50 58C54.4183 58 58 54.4183 58 50C58 45.5817 54.4183 42 50 42Z"/>
                  </mask>
                  <path d="M19.265 55.2132L22.2142 59.2507L19.265 55.2132ZM20.0943 53.3553L15.1103 53.7558L20.0943 53.3553ZM11.9633 60.5468L9.01399 56.5092L11.9633 60.5468ZM21.8479 77.6674L23.8699 82.2404L21.8479 77.6674ZM19.307 76.8383L23.6372 74.3383L19.307 76.8383ZM31.8677 74.4008L34.8246 70.3689L31.8677 74.4008ZM29.7945 74.1537L31.8165 78.7266L29.7945 74.1537ZM39.175 79.4821L44.1462 78.9467L39.175 79.4821ZM37.8828 77.7927L39.8009 73.1752L37.8828 77.7927ZM40.1154 88.2141L35.1441 88.7495L40.1154 88.2141ZM62.1172 77.7927L64.0353 82.4101L62.1172 77.7927ZM60.825 79.4821L55.8538 78.9467L60.825 79.4821ZM88.0367 60.5467L85.0875 64.5843L88.0367 60.5467ZM88.5891 63.1617L84.2589 60.6617L88.5891 63.1617ZM79.9057 53.3552L84.8897 53.7558L79.9057 53.3552ZM80.735 55.2131L77.7858 59.2507L80.735 55.2131ZM80.735 44.7869L77.7858 40.7493L80.735 44.7869ZM79.9057 46.6448L74.9218 47.0453L79.9057 46.6448ZM88.5891 36.8383L92.9192 34.3383L88.5891 36.8383ZM88.0367 39.4533L85.0875 35.4157L88.0367 39.4533ZM78.1521 22.3326L80.1741 26.9055L78.1521 22.3326ZM80.6929 23.1618L76.3628 25.6618L80.6929 23.1618ZM29.7945 25.8463L27.7725 30.4192L29.7945 25.8463ZM68.1323 25.5992L65.1754 29.6312L68.1323 25.5992ZM70.2056 25.8463L68.1836 21.2734L70.2056 25.8463ZM19.307 23.1617L14.9769 20.6617L19.307 23.1617ZM60.825 20.5179L55.8538 21.0533L60.825 20.5179ZM62.1172 22.2073L60.1991 26.8248L62.1172 22.2073ZM70.2056 74.1537L68.1836 78.7266L70.2056 74.1537ZM68.1323 74.4008L71.0892 78.4328L68.1323 74.4008ZM11.9633 39.4532L9.01399 43.4908L11.9633 39.4532ZM11.4109 36.8382L7.08078 34.3382L11.4109 36.8382ZM40.1154 11.7859L45.0866 12.3212L40.1154 11.7859ZM80.6929 76.8382L76.3628 74.3382L80.6929 76.8382ZM78.1521 77.6674L76.1301 82.2403L78.1521 77.6674ZM19.265 44.7868L22.2142 40.7493L19.265 44.7868ZM59.8846 11.7859L64.8559 11.2505L59.8846 11.7859ZM57.8961 5H42.1039V15H57.8961V5ZM65.7963 19.9826L64.8559 11.2505L54.9134 12.3212L55.8538 21.0533L65.7963 19.9826ZM71.0892 21.5672C68.9211 19.9772 66.5556 18.6368 64.0353 17.5899L60.1991 26.8248C61.9739 27.562 63.6429 28.5073 65.1754 29.6312L71.0892 21.5672ZM76.1301 17.7597L68.1836 21.2734L72.2275 30.4192L80.1741 26.9055L76.1301 17.7597ZM92.9192 34.3383L85.0231 20.6618L76.3628 25.6618L84.2589 39.3383L92.9192 34.3383ZM83.6843 48.8244L90.986 43.4908L85.0875 35.4157L77.7858 40.7493L83.6843 48.8244ZM85 49C85 48.0733 84.9628 47.1542 84.8897 46.2442L74.9218 47.0453C74.9736 47.6891 75 48.3409 75 49H85ZM85 51V49H75V51H85ZM84.8897 53.7558C84.9628 52.8458 85 51.9267 85 51H75C75 51.6591 74.9736 52.3109 74.9218 52.9547L84.8897 53.7558ZM90.986 56.5092L83.6843 51.1756L77.7858 59.2507L85.0875 64.5843L90.986 56.5092ZM85.0231 79.3382L92.9192 65.6617L84.2589 60.6617L76.3628 74.3382L85.0231 79.3382ZM68.1836 78.7266L76.1301 82.2403L80.1741 73.0945L72.2275 69.5808L68.1836 78.7266ZM64.0353 82.4101C66.5556 81.3632 68.9211 80.0228 71.0892 78.4328L65.1754 70.3688C63.6429 71.4927 61.9739 72.438 60.1991 73.1752L64.0353 82.4101ZM64.8559 88.7495L65.7963 80.0174L55.8538 78.9467L54.9134 87.6788L64.8559 88.7495ZM42.1039 95H57.8961V85H42.1039V95ZM34.2037 80.0174L35.1441 88.7495L45.0866 87.6788L44.1462 78.9467L34.2037 80.0174ZM28.9108 78.4328C31.079 80.0228 33.4444 81.3632 35.9647 82.4101L39.8009 73.1752C38.0261 72.438 36.3571 71.4927 34.8246 70.3689L28.9108 78.4328ZM23.8699 82.2404L31.8165 78.7266L27.7725 69.5808L19.8259 73.0945L23.8699 82.2404ZM7.08078 65.6618L14.9769 79.3383L23.6372 74.3383L15.741 60.6618L7.08078 65.6618ZM16.3157 51.1756L9.01399 56.5092L14.9125 64.5843L22.2142 59.2507L16.3157 51.1756ZM15 51C15 51.9268 15.0372 52.8459 15.1103 53.7558L25.0782 52.9547C25.0264 52.3109 25 51.6591 25 51H15ZM15 49V51H25V49H15ZM15.1103 46.2442C15.0372 47.1541 15 48.0732 15 49H25C25 48.3409 25.0264 47.6891 25.0782 47.0453L15.1103 46.2442ZM9.01399 43.4908L16.3157 48.8244L22.2142 40.7493L14.9125 35.4157L9.01399 43.4908ZM14.9769 20.6617L7.08078 34.3382L15.741 39.3382L23.6372 25.6617L14.9769 20.6617ZM31.8165 21.2734L23.8699 17.7596L19.8259 26.9055L27.7725 30.4192L31.8165 21.2734ZM35.9647 17.5899C33.4444 18.6368 31.079 19.9772 28.9108 21.5672L34.8246 29.6311C36.3571 28.5073 38.0261 27.562 39.8009 26.8248L35.9647 17.5899ZM35.1441 11.2505L34.2037 19.9826L44.1462 21.0533L45.0866 12.3212L35.1441 11.2505ZM47 50C47 48.3431 48.3432 47 50 47V37C42.8203 37 37 42.8203 37 50H47ZM50 53C48.3432 53 47 51.6569 47 50H37C37 57.1797 42.8203 63 50 63V53ZM53 50C53 51.6569 51.6569 53 50 53V63C57.1797 63 63 57.1797 63 50H53ZM50 47C51.6569 47 53 48.3431 53 50H63C63 42.8203 57.1797 37 50 37V47ZM39.8009 26.8248C42.0784 25.8787 43.8563 23.7455 44.1462 21.0533L34.2037 19.9826C34.3305 18.8052 35.0942 17.9515 35.9647 17.5899L39.8009 26.8248ZM22.2142 59.2507C24.291 57.7337 25.2664 55.2965 25.0782 52.9547L15.1103 53.7558C15.0381 52.8573 15.4082 51.8385 16.3157 51.1756L22.2142 59.2507ZM15.741 60.6618C16.5073 61.989 16.1501 63.6803 14.9125 64.5843L9.01399 56.5092C6.12642 58.6185 5.29285 62.565 7.08078 65.6618L15.741 60.6618ZM19.8259 73.0945C21.2275 72.4748 22.8709 73.0111 23.6372 74.3383L14.9769 79.3383C16.7649 82.4351 20.5994 83.6864 23.8699 82.2404L19.8259 73.0945ZM34.8246 70.3689C32.8747 68.9389 30.196 68.5092 27.7725 69.5808L31.8165 78.7266C30.757 79.1951 29.6579 78.9807 28.9108 78.4328L34.8246 70.3689ZM44.1462 78.9467C43.8563 76.2545 42.0784 74.1213 39.8009 73.1752L35.9647 82.4101C35.0942 82.0485 34.3305 81.1948 34.2037 80.0174L44.1462 78.9467ZM42.1039 85C43.6364 85 44.9225 86.1551 45.0866 87.6788L35.1441 88.7495C35.527 92.3048 38.528 95 42.1039 95V85ZM54.9134 87.6788C55.0775 86.1551 56.3636 85 57.8961 85V95C61.472 95 64.473 92.3048 64.8559 88.7495L54.9134 87.6788ZM60.1991 73.1752C57.9216 74.1213 56.1437 76.2546 55.8538 78.9467L65.7963 80.0174C65.6695 81.1948 64.9058 82.0485 64.0353 82.4101L60.1991 73.1752ZM85.0875 64.5843C83.8499 63.6803 83.4927 61.9889 84.2589 60.6617L92.9192 65.6617C94.7072 62.5649 93.8736 58.6184 90.986 56.5092L85.0875 64.5843ZM74.9218 52.9547C74.7336 55.2964 75.709 57.7337 77.7858 59.2507L83.6843 51.1756C84.5918 51.8385 84.9619 52.8573 84.8897 53.7558L74.9218 52.9547ZM77.7858 40.7493C75.709 42.2663 74.7336 44.7036 74.9218 47.0453L84.8897 46.2442C84.9619 47.1427 84.5918 48.1615 83.6843 48.8244L77.7858 40.7493ZM84.2589 39.3383C83.4927 38.0111 83.8499 36.3197 85.0875 35.4157L90.986 43.4908C93.8736 41.3816 94.7071 37.4351 92.9192 34.3383L84.2589 39.3383ZM80.1741 26.9055C78.7725 27.5253 77.1291 26.989 76.3628 25.6618L85.0231 20.6618C83.2351 17.565 79.4006 16.3136 76.1301 17.7597L80.1741 26.9055ZM27.7725 30.4192C30.196 31.4908 32.8747 31.0611 34.8246 29.6311L28.9108 21.5672C29.6579 21.0193 30.757 20.8049 31.8165 21.2734L27.7725 30.4192ZM65.1754 29.6312C67.1253 31.0611 69.804 31.4908 72.2275 30.4192L68.1836 21.2734C69.243 20.8049 70.3421 21.0193 71.0892 21.5672L65.1754 29.6312ZM23.6372 25.6617C22.8709 26.9889 21.2275 27.5252 19.8259 26.9055L23.8699 17.7596C20.5994 16.3136 16.7649 17.5649 14.9769 20.6617L23.6372 25.6617ZM55.8538 21.0533C56.1437 23.7455 57.9216 25.8787 60.1991 26.8248L64.0353 17.5899C64.9058 17.9515 65.6695 18.8052 65.7963 19.9826L55.8538 21.0533ZM72.2275 69.5808C69.804 68.5092 67.1253 68.9389 65.1754 70.3688L71.0892 78.4328C70.3421 78.9807 69.243 79.1951 68.1836 78.7266L72.2275 69.5808ZM14.9125 35.4157C16.15 36.3196 16.5073 38.011 15.741 39.3382L7.08078 34.3382C5.29284 37.435 6.12643 41.3815 9.01399 43.4908L14.9125 35.4157ZM42.1039 5C38.528 5 35.527 7.69517 35.1441 11.2505L45.0866 12.3212C44.9225 13.8449 43.6364 15 42.1039 15V5ZM76.3628 74.3382C77.1291 73.011 78.7725 72.4747 80.1741 73.0945L76.1301 82.2403C79.4006 83.6864 83.2351 82.435 85.0231 79.3382L76.3628 74.3382ZM25.0782 47.0453C25.2664 44.7035 24.291 42.2663 22.2142 40.7493L16.3157 48.8244C15.4082 48.1615 15.0381 47.1427 15.1103 46.2442L25.0782 47.0453ZM57.8961 15C56.3636 15 55.0775 13.8449 54.9134 12.3212L64.8559 11.2505C64.473 7.69517 61.472 5 57.8961 5V15Z" fill="currentColor" mask="url(#path-1-inside-1_68_39)"/>
                </svg>
              </div>
              <div className="aside-link-text">設定</div>
            </Link>
          </div>
        </div>
      </div>
      {<Footer />}
    </aside>
  );
};
